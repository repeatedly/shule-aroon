<?r recent, others = get_sites(get_common_domain_cookie) ?>

<?r unless recent or others ?>
<div id="description">
  <h2>No entries.</h2>
  <p>
    Password change sites don't exist Identity Providers.
  </p>
</div>
<?r else ?>
<div id="description">
  <h2>Select your Identity Provider.</h2>
  <p>
    Select from following IdP list for Password change.
  </p>
</div>

<?r if recent ?>
<div id="recent_IdP">
  <p>Recently selected Identity Provider.</p>
  <?r recent.each_pair do |entity_id, value| ?>
  <ul>
    <li><a href="#{value[:site]}">#{value[:name]}</a></li>
  </ul>
  <?r end ?>
</div>
<?r end ?>

<?r if others ?>
<form id="select_IdP" action="./transfer" method="get">
  <fieldset>
    <legend>Identity Provider List</legend>
    <select name="user_IdP">
    <?r others.each_pair do |fed_name, idp| ?>
    <optgroup label="#{fed_name}">
      <?r idp.each_pair do |entity_id, value| ?>
      <option value="#{value[:site]}">#{value[:name]}</option>
      <?r end ?>
    </optgroup>
    <?r end ?>
    </select>
    <input type="submit" name="select_IdP" value="Select" /><br />
  </fieldset>
</form>
<?r end ?>

<?r end ?>
